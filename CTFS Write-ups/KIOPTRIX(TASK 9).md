LINK: https://www.vulnhub.com/entry/kioptrix-level-12-3%2C24/
NAME: KIOPTRIX
WEB APPLICATION

NOTE: (PHYMYADMIN IS USED FOR MANAGING MYSQL DATABASE AND SHOULD BE PROTECTED OR LIMITED TO AUTHORIZED HOSTS.)

ENUMERATION:
--
WE WILL BE USING NMAP TO SCAN FOR OPEN PORTS ON THE TARGET IP.
![[VirtualBox_LINUX SERVER_23_04_2024_20_24_59.png]]TWO PORTS FOUND: 
SSH(22) AND HTTP(80).

I HAVE TRIED LOGGING IN VIA SSH, IT DIDN'T WORK. I'LL HAVE TO TRY VISITING APACHE SERVER RUNNING ON PORT 80 HTTP. FIRSTLT, I'LL ADD THE TARGET IP TO MY /ETC/HOSTS CONFIGURATION FILE TO BE ABLE TO LOAD THE WEBPAGE QUICKLY.
![[VirtualBox_LINUX SERVER_23_04_2024_20_44_06.png]]I WENT TO THE BLOG PAGE AND READ THE DOCUMENTATION, I REALIZED THAT THE PAGE IS BEING HOSTED ON HTTP://KIOPTRIX3.COM AND IT HAS A GALLERY PAGE. 
![[VirtualBox_LINUX SERVER_23_04_2024_20_51_32.png]]I VISITED THE LINK PROVIDED HTTP://KIOPTRIX3.COM/GALLERY WHICH SHOWS THE GALLERY PAGE OF THE WEBSITE
![[VirtualBox_LINUX SERVER_23_04_2024_20_53_42.png]]NOTHING MUCH TO DO HERE.
I FOUND A LOGIN PAGE ON THE WEBSITE
![[VirtualBox_LINUX SERVER_23_04_2024_20_56_08.png]]I FOUND THE NAME OF THE CMS, WHICH IS LOTUSCMS, LET'S CHECK IF IT HAS KNOWN EXPLOIT USING METASPLOIT.
![[VirtualBox_LINUX SERVER_23_04_2024_21_02_09.png]]
USING SHOW OPTIONS COMMAND TO VIEW THE AVAILABLE OPTIONS. I SET MY RHOST,URI AND CHANGED THE PAYLOAD TO GENERIC/SHELL_BIND_TCP.
![[VirtualBox_LINUX SERVER_23_04_2024_21_09_50.png]]![[VirtualBox_LINUX SERVER_23_04_2024_21_12_58 1.png]]I WAS ABLE TO GET A REVERSE SHELL!
![[VirtualBox_LINUX SERVER_23_04_2024_22_02_40.png]]![[VirtualBox_LINUX SERVER_23_04_2024_22_00_41.png]]
I LOGGED IN AS ROOT WITH THE CREDENTIALS FOUND.![[VirtualBox_LINUX SERVER_23_04_2024_22_06_35.png]]
BROWSE TO GALLERY AND THEN TO DEV_ACCOUNT
![[VirtualBox_LINUX SERVER_23_04_2024_22_07_33.png]]NAVIGATING THROUGH THE DEV_ACCOUNTS DIRETORY, I FOUND SOME USERNAMES AND PASSWORDS WHICH INCLUDED WAS "LONEFERRET". THE NAME OF THE NEW EMPLOYEE.
 ![[VirtualBox_LINUX SERVER_23_04_2024_22_09_24.png]]WE SEE THE PASSOWRD HASH FOR THE USER LONEFERRET. WE WILL CRACK IT USING JOHN THE RIPPER, A PASSWORD CRACKING TOOL I'LL COPY THE PASSWORD INTO A FILE.
 IN ORDER TO IDENTIFY THE HASH TYPE IN USE, I'LL USE HASH-IDENTIFIER COMMAND.
 ![[VirtualBox_LINUX SERVER_23_04_2024_22_35_41.png]]
 IT APPEARS TO BE AN MD5 HASH.
 WE WILL USE THE MD5 SYNTAX WITH JOHN THE RIPPER.
 ![[VirtualBox_LINUX SERVER_23_04_2024_22_37_15.png]]
 JOHN CRACKED THE PASSWORD AND WE NOW KNOW THE PASSWORD IS "STARWARS".
 --FORMAT=RAW-MD5 - INDICATED THAT IT IS AN MD5 HASH
SINCE WE HAVE AN IDEA OF THE USERNAME AND PASSWORD, I WILL TRY LOGGING IN VIA SSH WITH THE USER "LONEFERRET" AND PASSWORD "STARWARS".
![[VirtualBox_LINUX SERVER_23_04_2024_22_46_33.png]]FOUDN A FILE IN THE DIRECTORY , I'LL READ USING CAT.
![[VirtualBox_LINUX SERVER_23_04_2024_22_48_07.png]]IT IS ASKING US TO USE THE COMMAND "SUDO HT". IT THROWS UP AN ERROR. I'LL VIEW THE COMMANDS THE USER CAN RUN AS ROOT BY RUNNING "SUDO -l".
![[VirtualBox_LINUX SERVER_23_04_2024_22_50_28.png]]WE CAN SEE THE USER IS ABLE TO RUN /USR/BIN/SU AND /USR/LOCAL/BIN/HT AS THE ROOT USER. IF WE RUN "SUDO HT" AGAIN, WE WILL GET THE SAME ERROR, WE CAN RESOLVE THIS BY DOING AN "export TERM=xterm".
![[VirtualBox_LINUX SERVER_23_04_2024_22_56_33.png]]
![[VirtualBox_LINUX SERVER_23_04_2024_22_56_01.png]]WE ARE GREETED WITH THE HT TEXT EDITOR. THE GOAL IS MAKE THE LONEFERRET USER HAVE SUPERUSER PERMISSIONS OVER ALL COMMANDS
I WILL PRESS ALT+F AND GO TO OPEN:
![[VirtualBox_LINUX SERVER_23_04_2024_22_59_08.png]]THEN ENTER THE /ETC/SUDOERS FILE
![[VirtualBox_LINUX SERVER_23_04_2024_23_00_12.png]]
WE ARE NOW IN THE /ETC/SUDOERS FILE, WHERE WE WILL GRANTE LONEFERRET WITH ROOT PRIVILEGES.
![[VirtualBox_LINUX SERVER_23_04_2024_23_00_34.png]]I WILL REMOVE EVERYTHING ON THE LONEFERRET LINE AND REPLACE IT WITH THE SAME OPTIONS AS ROOT.
![[VirtualBox_LINUX SERVER_23_04_2024_23_03_54.png]]FROM HERE, I WILL SAVE USING ALT+F AGAIN AND CLOSE.
![[VirtualBox_LINUX SERVER_23_04_2024_23_10_31.png]]
WE CAN NOW RUN SUDO SU AND WE FINALLY GOT INTO THE ROOT ACCOUNT.
